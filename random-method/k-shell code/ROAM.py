import networkx as nx
import random
import xlwt
from collections import defaultdict

# 该函数为k-shell分解算法
def k_shell(graph_copy):
    graph = nx.Graph(graph_copy)  # 复制一个图
    importance_dict = defaultdict(list)
    k = 1  # 初始k值
    while len(graph.degree):  # 返回节点的个数
        while True:
            level_node_list = []
            for item in graph.degree:  # 列表元祖，元组前面是节点编号，后面是节点的度
                if item[1] <= k:
                    level_node_list.append(item[0])
            graph.remove_nodes_from(level_node_list)
            importance_dict[k].extend(level_node_list)
            if not len(graph.degree):
                return importance_dict
            if min(graph.degree, key=lambda x: x[1])[1] > k:
                break
        k = min(graph.degree, key=lambda x: x[1])[1]
    return importance_dict

def difference(S, R):
    DIF = nx.create_empty_copy(R)
    DIF.name ="Difference of (%s and %s)" % (S.name, R.name)
    if set(S) != set(R):
        raise nx.NetworkXError("Node sets of graphs is not equal")

    r_edges = set(R.edges())
    s_edges = set(S.edges())

    # I'm not sure what the goal is: the difference, or the edges that are in R but not in S
    # In case it is the difference:
    diff_edges = r_edges.symmetric_difference(s_edges)

    # In case its the edges that are in R but not in S:
    # diff_edges = r_edges - s_edges

    DIF.add_edges_from(diff_edges)

    return DIF



if __name__ == "__main__":
    li = [4, 0, 10, 7, 14, 0, 22, 19, 24, 2, 24, 4, 24, 6, 25, 3, 27, 4, 29, 25, 30, 6, 30, 24, 31, 28, 32, 6, 32, 12, 34, 24, 37, 5, 39, 16, 39, 23, 40, 22, 40, 39, 41, 17, 44, 11, 46, 6, 47, 8, 48, 9, 48, 30, 48, 44, 49, 27, 50, 20, 50, 29, 51, 42, 52, 1, 52, 17, 52, 24, 52, 37, 52, 45, 54, 32, 54, 43, 55, 12, 55, 32, 59, 4, 59, 40, 60, 23, 61, 20, 61, 42, 61, 58, 63, 36, 64, 7, 64, 51, 65, 1, 65, 7, 65, 58, 66, 26, 66, 56, 67, 12, 67, 48, 69, 39, 70, 28, 71, 12, 72, 48, 73, 14, 73, 32, 74, 22, 75, 3, 75, 23, 76, 56, 78, 14, 78, 17, 78, 41, 79, 19, 79, 78, 81, 71, 82, 57, 83, 28, 83, 61, 84, 8, 84, 61, 85, 16, 85, 31, 86, 43, 86, 53, 87, 12, 87, 24, 87, 51, 88, 16, 88, 34, 88, 73, 89, 1, 89, 26, 90, 2, 90, 74, 91, 5, 91, 24, 91, 25, 91, 31, 91, 65, 92, 12, 92, 30, 92, 42, 92, 64, 92, 69, 92, 70, 92, 71, 93, 10, 94, 58, 94, 61, 94, 74, 94, 90, 95, 65, 96, 24, 96, 58, 96, 84, 97, 7, 97, 9, 97, 39, 97, 77, 98, 22, 98, 79, 99, 59, 99, 66, 99, 85, 100, 21, 100, 29, 100, 65, 101, 37, 101, 83, 102, 21, 102, 52, 102, 59, 102, 74, 103, 25, 103, 49, 103, 94, 104, 10, 104, 21, 104, 29, 104, 42, 104, 102, 105, 93, 106, 26, 106, 27, 106, 30, 106, 32, 106, 54, 106, 59, 106, 87, 107, 26, 107, 47, 107, 48, 107, 54, 107, 89, 108, 44, 109, 0, 109, 15, 109, 27, 109, 45, 109, 93, 110, 30, 112, 68, 112, 87, 113, 3, 113, 51, 113, 80, 113, 82, 114, 24, 114, 29, 114, 37, 114, 85, 114, 99, 115, 72, 115, 100, 116, 20, 116, 59, 116, 72, 116, 115, 117, 88, 117, 100, 118, 20, 118, 43, 118, 49, 119, 45, 119, 46, 119, 77, 119, 113, 120, 55, 120, 78, 121, 23, 121, 91, 122, 52, 122, 63, 123, 57, 123, 90, 124, 4, 124, 5, 124, 13, 124, 37, 124, 97, 124, 103, 124, 108, 125, 8, 125, 69, 125, 85, 125, 88, 125, 98, 125, 99, 126, 92, 126, 106, 127, 5, 127, 23, 127, 33, 128, 21, 128, 90, 128, 121, 129, 81, 130, 63, 130, 100, 131, 38, 131, 48, 131, 80, 132, 86, 132, 95, 132, 110, 132, 120, 132, 128, 132, 129, 133, 22, 133, 71, 133, 81, 134, 19, 134, 27, 134, 63, 135, 23, 135, 47, 136, 11, 136, 65, 137, 40, 137, 55, 137, 57, 137, 84, 137, 106, 138, 56, 139, 113, 139, 123, 140, 39, 140, 55, 142, 8, 142, 62, 142, 64, 142, 98, 142, 108, 143, 0, 143, 48, 143, 60, 143, 64, 143, 75, 143, 119, 144, 3, 144, 9, 144, 15, 144, 39, 145, 51, 145, 61, 145, 71, 145, 134, 146, 2, 146, 40, 146, 54, 146, 67, 146, 77, 146, 80, 146, 98, 146, 103, 147, 82, 147, 105, 147, 146, 148, 13, 148, 21, 148, 115, 149, 40, 149, 63, 149, 112, 149, 125, 149, 145, 150, 132, 151, 3, 151, 18, 151, 39, 151, 48, 151, 112, 151, 150, 152, 0, 152, 58, 152, 61, 152, 78, 152, 84, 152, 119, 153, 46, 153, 128, 153, 151, 154, 32, 154, 74, 154, 83, 154, 139, 155, 0, 155, 94, 155, 105, 155, 111, 155, 113, 156, 38, 156, 144, 156, 149, 157, 84, 157, 111, 157, 116, 158, 3, 158, 4, 158, 26, 158, 42, 158, 50, 158, 53, 158, 101, 159, 9, 159, 38, 159, 41, 159, 76, 159, 84, 159, 91, 159, 124, 159, 148, 160, 28, 160, 32, 160, 49, 160, 58, 160, 93, 160, 144, 161, 13, 161, 19, 161, 30, 161, 61, 161, 117, 161, 141, 162, 2, 162, 3, 162, 89, 162, 118, 163, 47, 163, 77, 163, 112, 163, 134, 163, 160, 164, 13, 164, 80, 164, 82, 164, 112, 165, 10, 165, 15, 165, 53, 166, 25, 166, 116, 166, 137, 166, 152, 167, 95, 167, 123, 167, 136, 167, 149, 168, 21, 168, 77, 168, 84, 168, 103, 168, 129, 169, 31, 169, 69, 169, 80, 169, 93, 169, 111, 169, 126, 169, 129, 169, 149, 170, 5, 170, 24, 170, 68, 170, 114, 170, 156, 171, 11, 171, 31, 171, 44, 171, 79, 171, 91, 172, 41, 172, 57, 172, 82, 172, 103, 173, 5, 173, 9, 173, 58, 173, 66, 173, 99, 173, 100, 173, 104, 173, 105, 174, 10, 174, 12, 174, 38, 174, 74, 174, 81, 174, 106, 174, 161, 174, 164, 174, 173, 175, 52, 175, 57, 175, 63, 175, 78, 175, 96, 175, 109, 175, 153, 176, 34, 176, 115, 176, 162, 177, 2, 177, 20, 177, 53, 177, 60, 177, 63, 178, 33, 178, 63, 178, 83, 178, 129, 178, 169, 179, 17, 179, 31, 179, 36, 179, 48, 179, 52, 179, 108, 179, 116, 179, 118, 180, 8, 180, 47, 180, 62, 180, 86, 181, 24, 181, 27, 181, 118, 181, 126, 181, 155, 182, 17, 182, 74, 182, 159, 183, 45, 183, 62, 183, 111, 183, 122, 183, 137, 183, 167, 183, 175, 184, 3, 184, 4, 184, 88, 184, 100, 184, 161, 184, 164, 184, 174, 184, 177, 185, 13, 185, 57, 185, 102, 186, 12, 186, 20, 186, 22, 186, 43, 186, 121, 186, 128, 186, 162, 186, 168, 187, 49, 187, 182, 188, 16, 188, 19, 188, 39, 188, 45, 188, 120, 188, 136, 188, 170, 188, 183, 189, 2, 189, 3, 189, 9, 189, 163, 189, 173, 190, 5, 190, 133, 190, 175, 190, 179, 191, 17, 191, 106, 191, 127, 191, 146, 191, 166, 192, 41, 192, 165, 192, 176, 192, 190, 193, 86, 193, 123, 193, 138, 193, 177, 194, 19, 194, 114, 194, 152, 195, 2, 195, 7, 195, 55, 195, 63, 195, 91, 196, 53, 196, 56, 196, 85, 197, 15, 197, 21, 197, 50, 197, 53, 197, 86, 197, 110, 198, 18, 198, 161, 198, 164, 198, 168, 198, 173, 199, 15, 199, 161, 200, 28, 201, 10, 201, 36, 201, 38, 201, 60, 201, 94, 201, 174, 202, 27, 202, 44, 202, 50, 202, 155, 202, 173, 203, 43, 203, 57, 203, 59, 203, 89, 203, 112, 203, 139, 203, 180, 203, 190, 204, 10, 204, 23, 204, 76, 205, 185, 206, 43, 206, 56, 206, 144, 206, 187, 206, 205, 207, 22, 207, 47, 207, 52, 207, 113, 207, 146, 207, 158, 207, 173, 207, 203, 208, 4, 208, 50, 208, 87, 209, 9, 209, 15, 209, 22, 209, 62, 209, 199, 209, 202, 210, 58, 210, 83, 210, 118, 210, 119, 210, 188, 210, 189, 210, 205, 211, 3, 211, 10, 211, 25, 211, 38, 211, 44, 211, 47, 211, 182, 211, 187, 211, 200, 212, 54, 212, 116, 212, 129, 212, 187, 212, 197, 213, 16, 213, 82, 213, 157, 213, 173, 213, 181, 213, 196, 213, 200, 214, 11, 214, 176, 214, 194, 215, 27, 215, 87, 215, 138, 215, 141, 215, 143, 215, 159, 216, 35, 216, 117, 216, 130, 216, 165, 216, 195, 217, 8, 217, 36, 217, 67, 217, 68, 217, 122, 217, 142, 217, 144, 217, 214, 218, 36, 218, 166, 219, 20, 219, 33, 219, 61, 219, 80, 219, 81, 219, 92, 219, 111, 219, 134, 219, 156, 220, 13, 220, 36, 220, 44, 220, 48, 220, 50, 220, 95, 220, 108, 220, 122, 220, 148, 220, 212, 221, 27, 221, 32, 221, 48, 221, 69, 221, 77, 221, 197, 221, 202, 221, 220, 222, 11, 222, 71, 222, 77, 223, 78, 224, 11, 224, 146, 224, 167, 225, 40, 225, 78, 225, 84, 225, 96, 225, 103, 225, 114, 225, 173, 226, 22, 226, 52, 226, 56, 226, 83, 226, 127, 226, 195, 226, 201, 226, 217, 227, 45, 227, 47, 227, 67, 227, 95, 227, 121, 227, 142, 228, 34, 228, 78, 228, 124, 228, 181, 229, 47, 229, 132, 229, 166, 230, 13, 230, 58, 230, 127, 230, 181, 230, 221, 231, 19, 231, 44, 231, 47, 231, 54, 231, 56, 231, 80, 231, 105, 231, 156, 231, 159, 231, 198, 231, 214, 232, 22, 232, 59, 232, 136, 233, 13, 233, 19, 233, 42, 233, 74, 233, 109, 233, 158, 233, 198, 233, 210, 234, 46, 234, 54, 234, 122, 235, 29, 235, 91, 235, 102, 235, 119, 235, 120, 235, 156, 235, 195, 235, 198, 236, 46, 236, 49, 236, 62, 236, 160, 237, 26, 237, 105, 237, 190, 237, 232, 238, 32, 238, 147, 238, 191, 238, 198, 239, 13, 239, 124, 239, 128, 239, 130, 239, 197, 239, 201, 240, 10, 240, 25, 240, 115, 240, 126, 240, 152, 240, 160, 241, 28, 241, 64, 242, 22, 242, 81, 242, 109, 242, 115, 242, 175, 242, 190, 242, 239, 243, 95, 243, 103, 243, 120, 243, 123, 243, 139, 243, 146, 243, 156, 243, 185, 243, 193, 243, 208, 244, 88, 244, 122, 245, 6, 245, 11, 245, 24, 245, 88, 245, 95, 245, 216, 245, 233, 246, 53, 246, 63, 246, 100, 246, 135, 246, 181, 247, 23, 247, 60, 247, 134, 247, 195, 247, 236, 248, 86, 248, 89, 248, 114, 248, 142, 248, 167, 248, 168, 248, 222, 249, 16, 249, 19, 249, 97, 249, 161, 249, 192, 249, 204, 249, 215, 249, 219, 249, 226, 250, 8, 250, 97, 250, 152, 250, 171, 250, 173, 251, 38, 251, 59, 251, 143, 251, 162, 251, 232, 252, 33, 252, 34, 252, 101, 252, 121, 252, 125, 252, 129, 252, 171, 253, 51, 253, 68, 253, 69, 253, 89, 253, 169, 253, 249, 254, 181, 254, 203, 254, 249, 255, 16, 255, 64, 255, 197, 255, 211, 256, 59, 256, 106, 256, 145, 256, 171, 256, 208, 256, 220, 256, 228, 257, 6, 257, 8, 257, 39, 257, 53, 257, 107, 257, 149, 257, 192, 257, 198, 257, 241, 257, 253, 258, 72, 258, 91, 258, 105, 258, 108, 258, 145, 258, 209, 259, 105, 259, 108, 259, 141, 259, 160, 259, 169, 259, 194, 259, 208, 259, 228, 260, 7, 260, 11, 260, 24, 260, 64, 260, 136, 260, 192, 260, 207, 260, 218, 260, 234, 260, 245, 261, 22, 261, 23, 261, 97, 261, 122, 261, 194, 261, 196, 261, 250, 262, 39, 262, 147, 262, 173, 262, 187, 262, 188, 262, 246, 263, 65, 263, 104, 263, 124, 263, 148, 263, 201, 264, 40, 264, 99, 264, 183, 264, 218, 264, 241, 264, 250, 265, 24, 265, 146, 265, 150, 265, 158, 265, 220, 266, 6, 266, 15, 266, 45, 266, 77, 266, 129, 266, 260, 267, 0, 267, 14, 267, 71, 267, 80, 267, 112, 267, 117, 267, 147, 267, 152, 267, 239, 268, 10, 268, 96, 268, 143, 268, 181, 268, 248, 269, 128, 269, 157, 269, 246, 269, 258, 270, 35, 270, 36, 270, 67, 270, 101, 270, 141, 270, 155, 270, 176, 270, 181, 270, 269, 271, 3, 271, 55, 271, 91, 271, 109, 271, 159, 271, 184, 271, 192, 271, 201, 271, 246, 272, 159, 272, 178, 272, 184, 272, 190, 272, 233, 272, 234, 272, 236, 273, 53, 273, 74, 273, 103, 273, 110, 273, 168, 273, 175, 273, 193, 273, 230, 273, 263, 274, 15, 274, 27, 274, 32, 274, 40, 274, 64, 274, 76, 274, 95, 274, 157, 274, 205, 274, 271, 275, 98, 275, 119, 275, 182, 275, 207, 275, 215, 275, 232, 275, 262, 276, 1, 276, 73, 276, 185, 276, 226, 276, 228, 276, 233, 277, 16, 277, 80, 277, 138, 277, 141, 277, 169, 277, 175, 277, 210, 277, 257, 278, 28, 278, 62, 278, 66, 278, 111, 278, 140, 279, 5, 279, 26, 279, 138, 279, 173, 279, 174, 280, 1, 280, 12, 280, 23, 280, 83, 280, 149, 280, 162, 280, 192, 280, 204, 280, 263, 281, 188, 281, 209, 281, 222, 281, 242, 282, 56, 282, 67, 282, 126, 282, 133, 282, 145, 282, 182, 282, 190, 282, 221, 282, 244, 283, 187, 283, 233, 283, 272, 284, 2, 284, 5, 284, 26, 284, 33, 284, 67, 284, 153, 284, 163, 284, 198, 284, 228, 284, 230, 284, 277, 285, 21, 285, 32, 285, 37, 285, 50, 285, 77, 285, 107, 285, 109, 285, 137, 285, 220, 285, 230, 285, 246, 286, 20, 286, 132, 286, 148, 286, 161, 286, 183, 286, 198, 286, 259, 286, 263, 287, 0, 287, 73, 287, 114, 287, 116, 287, 119, 287, 149, 287, 152, 287, 169, 287, 172, 287, 194, 287, 211, 287, 247, 287, 273, 288, 70, 288, 87, 288, 97, 288, 98, 288, 102, 288, 161, 288, 187, 288, 229, 289, 11, 289, 24, 289, 36, 289, 104, 289, 112, 289, 114, 289, 117, 289, 132, 289, 174, 289, 211, 290, 66, 290, 110, 290, 116, 290, 137, 290, 159, 290, 199, 290, 245, 290, 254, 290, 278, 290, 279, 291, 44, 291, 68, 291, 132, 291, 163, 291, 235, 292, 120, 292, 151, 292, 198, 292, 200, 292, 206, 292, 218, 293, 15, 293, 59, 293, 94, 293, 168, 293, 188, 293, 202, 294, 3, 294, 136, 294, 150, 294, 160, 294, 201, 294, 207, 294, 219, 294, 235, 294, 245, 294, 247, 294, 257, 294, 269, 295, 4, 295, 16, 295, 45, 295, 83, 295, 114, 295, 134, 295, 183, 295, 231, 295, 273, 296, 53, 296, 84, 296, 93, 296, 175, 296, 188, 296, 195, 296, 203, 296, 239, 296, 242, 296, 244, 296, 263, 297, 31, 297, 104, 297, 131, 297, 179, 297, 186, 297, 253, 297, 291, 298, 61, 298, 110, 298, 141, 298, 168, 298, 191, 298, 201, 298, 216, 299, 2, 299, 82, 299, 157, 299, 221, 299, 246, 299, 249, 299, 282, 299, 296]
    print(len(li))

    G = nx.Graph()

    for i in range(0, len(li), 2):
        # print(li[i], li[i+1])
        G.add_edge(li[i], li[i+1])
    print(G)

    # 计算K-shell
    print("k-shell")
    k = k_shell(G)
    print(dict(k))
    k = {value: key for key, values in dict(k).items() for value in values}
    print(k)
    for v in G.nodes():
        print(v, k[v])

    # 计算PageRank
    print("PageRank")
    pr = nx.pagerank(G, alpha=0.85)
    # pr = sorted(pr.items(), key=lambda x: x[1], reverse=True)
    # print(pr)
    for v in G.nodes():
        print(v, pr[v])

    # 计算中介中心度
    print("Betweenness centrality")
    b = nx.betweenness_centrality(G)
    for v in G.nodes():
        # print("%s %0.6r" % (v, b[v]))
        # %s字符串，%0.6r浮点数子6位
        print(v, b[v])
    # 计算度中心度
    print("Degree centrality")
    d = nx.degree_centrality(G)
    for v in G.nodes():
        print(v, d[v])
    # 计算紧密中心度
    print("Closeness centrality")
    c = nx.closeness_centrality(G)
    for v in G.nodes():
        print(v, c[v])

    li_ = [4, 0, 10, 7, 14, 0, 22, 19, 24, 2, 24, 4, 24, 6, 25, 3, 27, 4, 29, 25, 30, 6, 30, 24, 31, 28, 32, 6, 32, 12, 34, 24, 37, 5, 39, 16, 39, 23, 40, 22, 40, 39, 41, 17, 44, 11, 46, 6, 47, 8, 48, 9, 48, 30, 48, 44, 49, 27, 50, 20, 50, 29, 51, 42, 52, 1, 52, 17, 52, 24, 52, 37, 52, 45, 54, 32, 54, 43, 55, 12, 55, 32, 59, 4, 59, 40, 60, 23, 61, 20, 61, 42, 61, 58, 63, 36, 64, 7, 64, 51, 65, 1, 65, 7, 65, 58, 66, 26, 66, 56, 67, 12, 67, 48, 69, 39, 70, 28, 71, 12, 72, 48, 73, 14, 73, 32, 74, 22, 75, 3, 75, 23, 76, 56, 78, 14, 78, 17, 78, 41, 79, 19, 79, 78, 81, 71, 82, 57, 83, 28, 83, 61, 84, 8, 84, 61, 85, 16, 85, 31, 86, 43, 86, 53, 87, 12, 87, 24, 87, 51, 88, 16, 88, 34, 88, 73, 89, 1, 89, 26, 90, 2, 90, 74, 91, 5, 91, 24, 91, 25, 91, 31, 91, 65, 92, 12, 92, 30, 92, 42, 92, 64, 92, 69, 92, 70, 92, 71, 93, 10, 94, 58, 94, 61, 94, 74, 94, 90, 95, 65, 96, 24, 96, 58, 96, 84, 97, 7, 97, 9, 97, 39, 97, 77, 98, 22, 98, 79, 99, 59, 99, 66, 99, 85, 100, 21, 100, 29, 100, 65, 101, 37, 101, 83, 102, 21, 102, 52, 102, 59, 102, 74, 103, 25, 103, 49, 103, 94, 104, 10, 104, 21, 104, 29, 104, 42, 104, 102, 105, 93, 106, 26, 106, 27, 106, 30, 106, 32, 106, 54, 106, 59, 106, 87, 107, 26, 107, 47, 107, 48, 107, 54, 107, 89, 108, 44, 109, 0, 109, 15, 109, 27, 109, 45, 109, 93, 110, 30, 112, 68, 112, 87, 113, 3, 113, 51, 113, 80, 113, 82, 114, 24, 114, 29, 114, 37, 114, 85, 114, 99, 115, 72, 115, 100, 116, 20, 116, 59, 116, 72, 116, 115, 117, 88, 117, 100, 118, 20, 118, 43, 118, 49, 119, 45, 119, 46, 119, 77, 119, 113, 120, 55, 120, 78, 121, 23, 121, 91, 122, 52, 122, 63, 123, 57, 123, 90, 124, 4, 124, 5, 124, 13, 124, 37, 124, 97, 124, 103, 124, 108, 125, 8, 125, 69, 125, 85, 125, 88, 125, 98, 125, 99, 126, 92, 126, 106, 127, 5, 127, 23, 127, 33, 128, 21, 128, 90, 128, 121, 129, 81, 130, 63, 130, 100, 131, 38, 131, 48, 131, 80, 132, 86, 132, 95, 132, 110, 132, 120, 132, 128, 132, 129, 133, 22, 133, 71, 133, 81, 134, 19, 134, 27, 134, 63, 135, 23, 135, 47, 136, 11, 136, 65, 137, 40, 137, 55, 137, 57, 137, 84, 137, 106, 138, 56, 139, 113, 139, 123, 140, 39, 140, 55, 142, 8, 142, 62, 142, 64, 142, 98, 142, 108, 143, 0, 143, 48, 143, 60, 143, 64, 143, 75, 143, 119, 144, 3, 144, 9, 144, 15, 144, 39, 145, 51, 145, 61, 145, 71, 145, 134, 146, 2, 146, 40, 146, 54, 146, 67, 146, 77, 146, 80, 146, 98, 146, 103, 147, 82, 147, 105, 147, 146, 148, 13, 148, 21, 148, 115, 149, 40, 149, 63, 149, 112, 149, 125, 149, 145, 150, 132, 151, 3, 151, 18, 151, 39, 151, 48, 151, 112, 151, 150, 152, 0, 152, 58, 152, 61, 152, 78, 152, 84, 152, 119, 153, 46, 153, 128, 153, 151, 154, 32, 154, 74, 154, 83, 154, 139, 155, 0, 155, 94, 155, 105, 155, 111, 155, 113, 156, 38, 156, 144, 156, 149, 157, 84, 157, 111, 157, 116, 158, 3, 158, 4, 158, 26, 158, 42, 158, 50, 158, 53, 158, 101, 159, 9, 159, 38, 159, 41, 159, 76, 159, 84, 159, 91, 159, 124, 159, 148, 160, 28, 160, 32, 160, 49, 160, 58, 160, 93, 160, 144, 161, 13, 161, 19, 161, 30, 161, 61, 161, 117, 161, 141, 162, 2, 162, 3, 162, 89, 162, 118, 163, 47, 163, 77, 163, 112, 163, 134, 163, 160, 164, 13, 164, 80, 164, 82, 164, 112, 165, 10, 165, 15, 165, 53, 166, 25, 166, 116, 166, 137, 166, 152, 167, 95, 167, 123, 167, 136, 167, 149, 168, 21, 168, 77, 168, 84, 168, 103, 168, 129, 169, 31, 169, 69, 169, 80, 169, 93, 169, 111, 169, 126, 169, 129, 169, 149, 170, 5, 170, 24, 170, 68, 170, 114, 170, 156, 171, 11, 171, 31, 171, 44, 171, 79, 171, 91, 172, 41, 172, 57, 172, 82, 172, 103, 174, 10, 174, 12, 174, 38, 174, 74, 174, 81, 174, 106, 174, 161, 174, 164, 175, 52, 175, 57, 175, 63, 175, 78, 175, 96, 175, 109, 175, 153, 176, 34, 176, 115, 176, 162, 177, 2, 177, 20, 177, 53, 177, 60, 177, 63, 178, 33, 178, 63, 178, 83, 178, 129, 178, 169, 179, 17, 179, 31, 179, 36, 179, 48, 179, 52, 179, 108, 179, 116, 179, 118, 180, 8, 180, 47, 180, 62, 180, 86, 181, 24, 181, 27, 181, 118, 181, 126, 181, 155, 182, 17, 182, 74, 182, 159, 183, 45, 183, 62, 183, 111, 183, 122, 183, 137, 183, 167, 183, 175, 184, 3, 184, 4, 184, 88, 184, 100, 184, 161, 184, 164, 184, 174, 184, 177, 185, 13, 185, 57, 185, 102, 186, 12, 186, 20, 186, 22, 186, 43, 186, 121, 186, 128, 186, 162, 186, 168, 187, 49, 187, 182, 188, 16, 188, 19, 188, 39, 188, 45, 188, 120, 188, 136, 188, 170, 188, 183, 189, 2, 189, 3, 189, 9, 189, 163, 189, 173, 190, 5, 190, 133, 190, 175, 190, 179, 191, 17, 191, 106, 191, 127, 191, 146, 191, 166, 192, 41, 192, 165, 192, 176, 192, 190, 193, 86, 193, 123, 193, 138, 193, 177, 194, 19, 194, 114, 194, 152, 195, 2, 195, 7, 195, 55, 195, 63, 195, 91, 196, 53, 196, 56, 196, 85, 197, 15, 197, 21, 197, 50, 197, 53, 197, 86, 197, 110, 198, 18, 198, 161, 198, 164, 198, 168, 199, 15, 199, 161, 200, 28, 201, 10, 201, 36, 201, 38, 201, 60, 201, 94, 201, 174, 202, 27, 202, 44, 202, 50, 202, 155, 203, 43, 203, 57, 203, 59, 203, 89, 203, 112, 203, 139, 203, 180, 203, 190, 204, 10, 204, 23, 204, 76, 205, 185, 206, 43, 206, 56, 206, 144, 206, 187, 206, 205, 207, 22, 207, 47, 207, 52, 207, 113, 207, 146, 207, 158, 207, 203, 208, 4, 208, 50, 208, 87, 209, 9, 209, 15, 209, 22, 209, 62, 209, 199, 209, 202, 210, 58, 210, 83, 210, 118, 210, 119, 210, 188, 210, 189, 210, 205, 211, 3, 211, 10, 211, 25, 211, 38, 211, 44, 211, 47, 211, 182, 211, 187, 211, 200, 212, 54, 212, 116, 212, 129, 212, 187, 212, 197, 213, 16, 213, 82, 213, 157, 213, 181, 213, 196, 213, 200, 214, 11, 214, 176, 214, 194, 215, 27, 215, 87, 215, 138, 215, 141, 215, 143, 215, 159, 216, 35, 216, 117, 216, 130, 216, 165, 216, 195, 217, 8, 217, 36, 217, 67, 217, 68, 217, 122, 217, 142, 217, 144, 217, 214, 218, 36, 218, 166, 219, 20, 219, 33, 219, 61, 219, 80, 219, 81, 219, 92, 219, 111, 219, 134, 219, 156, 220, 13, 220, 36, 220, 44, 220, 48, 220, 50, 220, 95, 220, 108, 220, 122, 220, 148, 220, 212, 221, 27, 221, 32, 221, 48, 221, 69, 221, 77, 221, 197, 221, 202, 221, 220, 222, 11, 222, 71, 222, 77, 223, 78, 224, 11, 224, 146, 224, 167, 225, 40, 225, 78, 225, 84, 225, 96, 225, 103, 225, 114, 226, 22, 226, 52, 226, 56, 226, 83, 226, 127, 226, 195, 226, 201, 226, 217, 227, 45, 227, 47, 227, 67, 227, 95, 227, 121, 227, 142, 228, 34, 228, 78, 228, 124, 228, 181, 229, 47, 229, 132, 229, 166, 230, 13, 230, 58, 230, 127, 230, 181, 230, 221, 231, 19, 231, 44, 231, 47, 231, 54, 231, 56, 231, 80, 231, 105, 231, 156, 231, 159, 231, 198, 231, 214, 232, 22, 232, 59, 232, 136, 233, 13, 233, 19, 233, 42, 233, 74, 233, 109, 233, 158, 233, 198, 233, 210, 234, 46, 234, 54, 234, 122, 235, 29, 235, 91, 235, 102, 235, 119, 235, 120, 235, 156, 235, 195, 235, 198, 236, 46, 236, 49, 236, 62, 236, 160, 237, 26, 237, 105, 237, 190, 237, 232, 238, 32, 238, 147, 238, 191, 238, 198, 239, 13, 239, 124, 239, 128, 239, 130, 239, 197, 239, 201, 240, 10, 240, 25, 240, 115, 240, 126, 240, 152, 240, 160, 241, 28, 241, 64, 242, 22, 242, 81, 242, 109, 242, 115, 242, 175, 242, 190, 242, 239, 243, 95, 243, 103, 243, 120, 243, 123, 243, 139, 243, 146, 243, 156, 243, 185, 243, 193, 243, 208, 244, 88, 244, 122, 245, 6, 245, 11, 245, 24, 245, 88, 245, 95, 245, 216, 245, 233, 246, 53, 246, 63, 246, 100, 246, 135, 246, 181, 247, 23, 247, 60, 247, 134, 247, 195, 247, 236, 248, 86, 248, 89, 248, 114, 248, 142, 248, 167, 248, 168, 248, 222, 249, 16, 249, 19, 249, 97, 249, 161, 249, 192, 249, 204, 249, 215, 249, 219, 249, 226, 250, 8, 250, 97, 250, 152, 250, 171, 251, 38, 251, 59, 251, 143, 251, 162, 251, 232, 252, 33, 252, 34, 252, 101, 252, 121, 252, 125, 252, 129, 252, 171, 253, 51, 253, 68, 253, 69, 253, 89, 253, 169, 253, 249, 254, 181, 254, 203, 254, 249, 255, 16, 255, 64, 255, 197, 255, 211, 256, 59, 256, 106, 256, 145, 256, 171, 256, 208, 256, 220, 256, 228, 257, 6, 257, 8, 257, 39, 257, 53, 257, 107, 257, 149, 257, 192, 257, 198, 257, 241, 257, 253, 258, 72, 258, 91, 258, 105, 258, 108, 258, 145, 258, 209, 259, 105, 259, 108, 259, 141, 259, 160, 259, 169, 259, 194, 259, 208, 259, 228, 260, 7, 260, 11, 260, 24, 260, 64, 260, 136, 260, 192, 260, 207, 260, 218, 260, 234, 260, 245, 261, 22, 261, 23, 261, 97, 261, 122, 261, 194, 261, 196, 261, 250, 262, 39, 262, 147, 262, 187, 262, 188, 262, 246, 263, 65, 263, 104, 263, 124, 263, 148, 263, 201, 264, 40, 264, 99, 264, 183, 264, 218, 264, 241, 264, 250, 265, 24, 265, 146, 265, 150, 265, 158, 265, 220, 266, 6, 266, 15, 266, 45, 266, 77, 266, 129, 266, 260, 267, 0, 267, 14, 267, 71, 267, 80, 267, 112, 267, 117, 267, 147, 267, 152, 267, 239, 268, 10, 268, 96, 268, 143, 268, 181, 268, 248, 269, 128, 269, 157, 269, 246, 269, 258, 270, 35, 270, 36, 270, 67, 270, 101, 270, 141, 270, 155, 270, 176, 270, 181, 270, 269, 271, 3, 271, 55, 271, 91, 271, 109, 271, 159, 271, 184, 271, 192, 271, 201, 271, 246, 272, 159, 272, 178, 272, 184, 272, 190, 272, 233, 272, 234, 272, 236, 273, 53, 273, 74, 273, 103, 273, 110, 273, 168, 273, 175, 273, 193, 273, 230, 273, 263, 274, 15, 274, 27, 274, 32, 274, 40, 274, 64, 274, 76, 274, 95, 274, 157, 274, 205, 274, 271, 275, 98, 275, 119, 275, 182, 275, 207, 275, 215, 275, 232, 275, 262, 276, 1, 276, 73, 276, 185, 276, 226, 276, 228, 276, 233, 277, 16, 277, 80, 277, 138, 277, 141, 277, 169, 277, 175, 277, 210, 277, 257, 278, 28, 278, 62, 278, 66, 278, 111, 278, 140, 279, 5, 279, 26, 279, 138, 279, 174, 280, 1, 280, 12, 280, 23, 280, 83, 280, 149, 280, 162, 280, 192, 280, 204, 280, 263, 281, 188, 281, 209, 281, 222, 281, 242, 282, 56, 282, 67, 282, 126, 282, 133, 282, 145, 282, 182, 282, 190, 282, 221, 282, 244, 283, 187, 283, 233, 283, 272, 284, 2, 284, 5, 284, 26, 284, 33, 284, 67, 284, 153, 284, 163, 284, 198, 284, 228, 284, 230, 284, 277, 285, 21, 285, 32, 285, 37, 285, 50, 285, 77, 285, 107, 285, 109, 285, 137, 285, 220, 285, 230, 285, 246, 286, 20, 286, 132, 286, 148, 286, 161, 286, 183, 286, 198, 286, 259, 286, 263, 287, 0, 287, 73, 287, 114, 287, 116, 287, 119, 287, 149, 287, 152, 287, 169, 287, 172, 287, 194, 287, 211, 287, 247, 287, 273, 288, 70, 288, 87, 288, 97, 288, 98, 288, 102, 288, 161, 288, 187, 288, 229, 289, 11, 289, 24, 289, 36, 289, 104, 289, 112, 289, 114, 289, 117, 289, 132, 289, 174, 289, 211, 290, 66, 290, 110, 290, 116, 290, 137, 290, 159, 290, 199, 290, 245, 290, 254, 290, 278, 290, 279, 291, 44, 291, 68, 291, 132, 291, 163, 291, 235, 292, 120, 292, 151, 292, 198, 292, 200, 292, 206, 292, 218, 293, 15, 293, 59, 293, 94, 293, 168, 293, 188, 293, 202, 294, 3, 294, 136, 294, 150, 294, 160, 294, 201, 294, 207, 294, 219, 294, 235, 294, 245, 294, 247, 294, 257, 294, 269, 295, 4, 295, 16, 295, 45, 295, 83, 295, 114, 295, 134, 295, 183, 295, 231, 295, 273, 296, 53, 296, 84, 296, 93, 296, 175, 296, 188, 296, 195, 296, 203, 296, 239, 296, 242, 296, 244, 296, 263, 297, 31, 297, 104, 297, 131, 297, 179, 297, 186, 297, 253, 297, 291, 298, 61, 298, 110, 298, 141, 298, 168, 298, 191, 298, 201, 298, 216, 299, 2, 299, 82, 299, 157, 299, 221, 299, 246, 299, 249, 299, 282, 299, 296]
    G_ = nx.Graph()

    for i in range(0, len(li_), 2):
        # print(li_[i], li_[i + 1])
        G_.add_edge(li_[i], li_[i + 1])
    print(G_)

    print(difference(G, G_).edges())
    print("differ edge:", len(difference(G, G_).edges()))

    # 计算K-shell
    print("k-shell")
    k_ = k_shell(G_)
    print(dict(k_))
    k_ = {value: key for key, values in dict(k_).items() for value in values}
    print(k_)
    for v in G_.nodes():
        print(v, k_[v])

    # 计算PageRank
    print("PageRank")
    pr_ = nx.pagerank(G_, alpha=0.85)
    # pr = sorted(pr.items(), key=lambda x: x[1], reverse=True)
    # print(pr)
    for v in G_.nodes():
        print(v, pr_[v])

    # 计算中介中心度
    print("Betweenness centrality")
    b_ = nx.betweenness_centrality(G_)
    for v in G_.nodes():
        # print("%s %0.6r" % (v, b[v]))
        # %s字符串，%0.6r浮点数子6位
        print(v, b_[v])
    # 计算度中心度
    print("Degree centrality")
    d_ = nx.degree_centrality(G_)
    for v in G_.nodes():
        print(v, d_[v])
    # 计算紧密中心度
    print("Closeness centrality")
    c_ = nx.closeness_centrality(G_)
    for v in G_.nodes():
        print(v, c_[v])

    # 创建Workbook,相当于创建Excel
    xls = xlwt.Workbook(encoding='utf-8')
    # 创建sheet，Sheet1为表的名字，cell_overwrite_ok为是否覆盖单元格
    sheet = xls.add_sheet('sheet1', cell_overwrite_ok=True)
    # 创建的文件夹，用来写入处理后的数据

    file = r"C:\Users\hello\Desktop\er300_roam.xls"
    # 向表中添加数据
    sheet.write(0, 0, 'id')
    sheet.write(0, 1, "Betweenness centrality")
    sheet.write(0, 2, "Degree centrality")
    sheet.write(0, 3, "Closeness centrality")
    sheet.write(0, 4, "PageRank")
    sheet.write(0, 5, "K-shell")
    sheet.write(0, 6, "Betweenness centrality")
    sheet.write(0, 7, "Degree centrality")
    sheet.write(0, 8, "Closeness centrality")
    sheet.write(0, 9, "PageRank")
    sheet.write(0, 10, "K-shell")
    m = 1
    for v in G.nodes():
        sheet.write(m, 0, v)
        sheet.write(m, 1, b[v])
        sheet.write(m, 2, d[v])
        sheet.write(m, 3, c[v])
        sheet.write(m, 4, pr[v])
        sheet.write(m, 5, k[v])
        sheet.write(m, 6, b_[v])
        sheet.write(m, 7, d_[v])
        sheet.write(m, 8, c_[v])
        sheet.write(m, 9, pr_[v])
        sheet.write(m, 10, k_[v])
        m = m + 1
    # 保存到excel中
    xls.save(file)
